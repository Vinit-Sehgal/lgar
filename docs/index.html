<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Visualization and Geospatial Analysis With R</title>
  <meta name="description" content="Data Visualization and Geospatial Analysis With R" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Data Visualization and Geospatial Analysis With R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Visualization and Geospatial Analysis With R" />
  
  
  

<meta name="author" content="Vinit Sehgal (Louisiana State University), Debasish Mishra (Texas A&amp;M University) &amp; Frank Adekilae (Louisiana State University)" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="import-libraries-and-sample-dataset.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/brick(sm)_b6de57-1/data_stars_bricksm19c3e2.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="libs/brick_sm_-CSS-0.0.1/brick_sm__home-button.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Large-scale Geospatial Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="import-libraries-and-sample-dataset.html"><a href="import-libraries-and-sample-dataset.html"><i class="fa fa-check"></i><b>2</b> Import libraries and sample dataset</a></li>
<li class="chapter" data-level="3" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html"><i class="fa fa-check"></i><b>3</b> Raster and shapefile visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#plotting-raster-data"><i class="fa fa-check"></i><b>3.1</b> Plotting raster data</a></li>
<li class="chapter" data-level="3.2" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#customizing-terra-plot-options"><i class="fa fa-check"></i><b>3.2</b> Customizing <code>terra</code> plot options</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#scientific-color-palettes"><i class="fa fa-check"></i><b>3.2.1</b> Scientific Color palettes</a></li>
<li class="chapter" data-level="3.2.2" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#customize-terra-plots"><i class="fa fa-check"></i><b>3.2.2</b> Customize <code>terra</code> plots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#plotting-raster-data-using-tidyterra"><i class="fa fa-check"></i><b>3.3</b> Plotting raster data using <code>tidyterra</code></a></li>
<li class="chapter" data-level="3.4" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#plotting-vector-data"><i class="fa fa-check"></i><b>3.4</b> Plotting vector data</a></li>
<li class="chapter" data-level="3.5" data-path="raster-and-shapefile-visualization.html"><a href="raster-and-shapefile-visualization.html#reprojection-of-rasters-using-terraproject"><i class="fa fa-check"></i><b>3.5</b> Reprojection of rasters using <code>terra::project</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geospatial-operations-on-rastervector-data.html"><a href="geospatial-operations-on-rastervector-data.html"><i class="fa fa-check"></i><b>4</b> Geospatial operations on raster/vector data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geospatial-operations-on-rastervector-data.html"><a href="geospatial-operations-on-rastervector-data.html#raster-resampling"><i class="fa fa-check"></i><b>4.1</b> Raster resampling</a></li>
<li class="chapter" data-level="4.2" data-path="geospatial-operations-on-rastervector-data.html"><a href="geospatial-operations-on-rastervector-data.html#raster-summary-statistics"><i class="fa fa-check"></i><b>4.2</b> Raster summary statistics</a></li>
<li class="chapter" data-level="4.3" data-path="geospatial-operations-on-rastervector-data.html"><a href="geospatial-operations-on-rastervector-data.html#summarizing-rasters-using-shapefles"><i class="fa fa-check"></i><b>4.3</b> Summarizing rasters using shapefles</a></li>
<li class="chapter" data-level="4.4" data-path="geospatial-operations-on-rastervector-data.html"><a href="geospatial-operations-on-rastervector-data.html#diy-summarize-raster-using-classified-raster"><i class="fa fa-check"></i><b>4.4</b> DIY: Summarize raster using classified raster</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html"><i class="fa fa-check"></i><b>5</b> Data-cubes or SpatRaster</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#create-subset-and-visualize-spatraster"><i class="fa fa-check"></i><b>5.1</b> Create, subset and visualize SpatRaster</a></li>
<li class="chapter" data-level="5.2" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#geospatial-operations-on-spatraster"><i class="fa fa-check"></i><b>5.2</b> Geospatial operations on SpatRaster</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#time-series-extraction-from-spatraster"><i class="fa fa-check"></i><b>5.2.1</b> Time-series extraction from SpatRaster</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#spatial-extractionsummary-from-spatraster"><i class="fa fa-check"></i><b>5.2.2</b> Spatial extraction/summary from SpatRaster</a></li>
<li class="chapter" data-level="5.2.3" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#crop-and-mask-spatraster"><i class="fa fa-check"></i><b>5.2.3</b> Crop and mask SpatRaster</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#layer-wise-operations-on-spatraster"><i class="fa fa-check"></i><b>5.3</b> Layer-wise operations on SpatRaster</a></li>
<li class="chapter" data-level="5.4" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#cell-wise-operations-with-app-lapp-tapp"><i class="fa fa-check"></i><b>5.4</b> Cell-wise operations with <code>app</code>, <code>lapp</code>, <code>tapp</code></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#app-cell-wise-operation-on-all-layers"><i class="fa fa-check"></i><b>5.4.1</b> app: Cell-wise operation on all layers</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#tapp-cell-wise-operation-on-layer-groups"><i class="fa fa-check"></i><b>5.4.2</b> tapp: Cell-wise operation on layer groups</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-cubes-or-spatraster.html"><a href="data-cubes-or-spatraster.html#lapp-layers-as-function-arguments"><i class="fa fa-check"></i><b>5.4.3</b> lapp: layers as function arguments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html"><i class="fa fa-check"></i><b>6</b> Parallel computation for geospatial analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#cellwise-implimentation-of-functions"><i class="fa fa-check"></i><b>6.1</b> Cellwise implimentation of functions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#apply-custom-function-to-pixel-time-series"><i class="fa fa-check"></i><b>6.1.1</b> Apply custom function to pixel time series</a></li>
<li class="chapter" data-level="6.1.2" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#best-practices-for-large-scale-operations"><i class="fa fa-check"></i><b>6.1.2</b> Best practices for large-scale operations</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#layerwise-implimentation-of-functions"><i class="fa fa-check"></i><b>6.2</b> Layerwise implimentation of functions</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#data-cubes-as-lists"><i class="fa fa-check"></i><b>6.2.1</b> Data cubes as lists</a></li>
<li class="chapter" data-level="6.2.2" data-path="parallel-computation-for-geospatial-analysis.html"><a href="parallel-computation-for-geospatial-analysis.html#blockwise-summary-of-feature-extracted-data"><i class="fa fa-check"></i><b>6.2.2</b> Blockwise summary of feature extracted data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="supplementary-material.html"><a href="supplementary-material.html"><i class="fa fa-check"></i><b>7</b> Supplementary material</a>
<ul>
<li class="chapter" data-level="7.1" data-path="supplementary-material.html"><a href="supplementary-material.html#exporting-spatraster-to-netcdf-data"><i class="fa fa-check"></i><b>7.1</b> Exporting SpatRaster to NetCDF Data</a></li>
<li class="chapter" data-level="7.2" data-path="supplementary-material.html"><a href="supplementary-material.html#updating-r-using-rstudio"><i class="fa fa-check"></i><b>7.2</b> Updating R using RStudio</a></li>
<li class="chapter" data-level="7.3" data-path="supplementary-material.html"><a href="supplementary-material.html#changing-temp-files-for-large-storage"><i class="fa fa-check"></i><b>7.3</b> Changing Temp files for large storage</a></li>
<li class="chapter" data-level="7.4" data-path="supplementary-material.html"><a href="supplementary-material.html#resampling-with-rgdalwarp"><i class="fa fa-check"></i><b>7.4</b> Resampling with rgdalwarp</a></li>
</ul></li>
<li class="divider"></li>
<li><a href=https://soil-hydrology.com/" target="blank">https://soil-hydrology.com/</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Visualization and Geospatial Analysis With R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Data Visualization and Geospatial Analysis With R</h1>
<p class="author"><em>Vinit Sehgal (Louisiana State University), Debasish Mishra (Texas A&amp;M University) &amp; Frank Adekilae (Louisiana State University)</em></p>
<p class="date"><em>December, 2025</em></p>
</div>
<div id="introduction" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction<a href="index.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>

<script>
   $(document).ready(function() {
     $head = $('#header');
   });
</script>
<center>
<img src="SampleData-master/images/cover_v3.png" style="width:100.0%" />
</center>
<p>Taking examples from global satellite data in <code>gridded/raster format</code>, we will demonstrate several common geospatial operations like <code>projections</code>, <code>resampling</code>, <code>cropping</code>, <code>masking</code>, <code>spatial extraction</code> etc. using rasters, shapefiles, and spatial data frames. For a seamless analysis across different datatypes and platforms, conversion from/to different data formats like data frames, matrices, rasters, and structured data like <code>NetCDF</code> will be discussed. Advanced topics will include working with data cubes (<code>SpatRaster</code>), layer-wise operations on data cubes, cell-wise operations on raster time series by implementing user-defined functions with <code>global</code>, <code>app</code>, <code>tapp</code> and <code>lapp</code>. Parallel implementation of custom functions will be demonstrated for large-scale datasets.</p>
<hr />
<p><strong>Course level: Advanced. Prior experience in R required.</strong></p>
<hr />
<p><strong>Materials</strong>: For this exercise, we will use global dataset from two <code>NASA</code> satellites- <code>MODIS for NDVI</code> and <code>SMAP for surface (~5cm) soil moisture</code>.
We will use global aridity estimates (from [Global Aridity and PET Database] (<a href="https://cgiarcsi.community/data/global-aridity-and-pet-database/" class="uri">https://cgiarcsi.community/data/global-aridity-and-pet-database/</a>) as a general <code>climate</code> classification (Hyper-arid, arid, semi-arid, sub-humid and humid).</p>
<p>The codes are tested on R <code>version 4.2.3- Shortstop Beagle</code> and <code>version 4.1.2 - Bird Hippie</code>.
To update, see section 5.2.</p>
<hr />
<p><strong>Instructors</strong>:</p>
<p><em>Vinit Sehgal</em> is an Assistant Professor of Soil Physics at the LSU AgCenter, School of Plant, Environmental, and Soil Sciences. His research is deeply rooted in soil science and hydrology, focusing on the intricate dynamics of soil moisture and its critical role in agricultural and environmental sustainability.</p>
<p><em>Debasish Mishra</em> is a PhD student in the Department of Biological &amp; Agricultural Engineering at Texas A&amp;M University. His research focuses on land-atmospheric interactions and its critical role in guiding ecosystem resilience.</p>
<p><em>Leah Kocian</em> is a PhD student in the Department of Biological &amp; Agricultural Engineering at Texas A&amp;M University. Her research focuses on contaminant transport in Urban settings, particularly relating to carcinogens and micro-plastics.</p>
<p><em>Frank Anyoka Adekilae</em> is a PhD student in the School of Plant, Environmental, and Soil Sciences at Louisiana State University. His research explores the connectivity between surface and rootzone soil moisture and its implications for hydrology and agricultural water management.</p>
<hr />
</div>
            </section>

          </div>
        </div>
      </div>

<a href="import-libraries-and-sample-dataset.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Vinit-Sehgal/lgar/edit/main/index.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Vinit-Sehgal/lgar/blob/main/index.Rmd",
    "text": null
  },
  "download": ["bookdownproj.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
